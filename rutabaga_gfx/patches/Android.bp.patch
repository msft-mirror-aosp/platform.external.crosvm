diff --git a/rutabaga_gfx/Android.bp b/rutabaga_gfx/Android.bp
index 3358d5055..b6bc63efa 100644
--- a/rutabaga_gfx/Android.bp
+++ b/rutabaga_gfx/Android.bp
@@ -23,7 +23,6 @@ rust_library {
     edition: "2021",
     features: [
         "gfxstream",
-        "gfxstream_stub",
         "virgl_renderer",
     ],
     rustlibs: [
@@ -37,11 +36,34 @@ rust_library {
         "libzerocopy",
     ],
     proc_macros: ["libremain"],
-    shared_libs: [
+    static_libs: [
         "libepoxy",
+        "libgfxstream_backend",
         "libvirglrenderer",
     ],
+    shared_libs: [
+        "libc++",
+        "libbase",
+    ],
     apex_available: ["com.android.virt"],
+    cfgs: [
+        "gfxstream_unstable",
+    ],
+    target: {
+        android: {
+            shared_libs: [
+                "libnativewindow",
+                "libcutils",
+                "liblog",
+            ],
+        },
+        host: {
+            features: ["vulkano"],
+            rustlibs: [
+                "libvulkano",
+            ],
+        },
+    },
 }
 
 rust_test {
@@ -60,7 +82,6 @@ rust_test {
     edition: "2021",
     features: [
         "gfxstream",
-        "gfxstream_stub",
         "virgl_renderer",
     ],
     rustlibs: [
@@ -77,6 +98,7 @@ rust_test {
     proc_macros: ["libremain"],
     shared_libs: [
         "libepoxy",
+        "libgfxstream_backend",
         "libvirglrenderer",
     ],
 }
